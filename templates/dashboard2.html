{% extends 'base.html' %}
{% block content %}

<h2>Sleep Insights</h2>

<!-- Non-visual insight elements -->
<div>
    <p>Average sleep per night: {{ '{0:0.1f}'.format(avg_sleep) }} hours</p>
    <p>Median sleep per night: {{ '{0:0.1f}'.format(median_sleep) }} hours</p>
    <p>Average insomnia severity: {{ '{0:0.1f}'.format(avg_insom_severity) }} / 10</p>
    <p>Median insomnia severity: {{ '{0:0.1f}'.format(median_insom_severity) }} / 10</p>
    <p>Insomnia and alcohol co-occurrence: {{ insom_and_alcohol_co_occurrence }}</p>

</div>

<!-- Donut chart element -->
<div class="melon-chart">
<canvas id="donutChart"></canvas>
<div id="donutLegend" class="chart-legend"></div>
</div>

<!-- Line graph element -->
<div class="melon-chart">
<canvas id="lineChart" width="100" height="30"></canvas>
<div id="lineLegend" class="chart-legend"></div>
</div>

<script src="https://code.jquery.com/jquery.js"></script>
<script src="static/dashboard.js"></script>

<!-- Creates graphs using chart.js -->
<script>

   var options = {
      responsive: true
    };

    // Creates donut chart of frequency of occurrences of different types of insomnia
    var ctx_donut = $("#donutChart").get(0).getContext("2d");

    $.get("/insom-types.json", function (data) {
      var myDonutChart = new Chart(ctx_donut).Doughnut(data.insom_type, options);
      $('#donutLegend').html(myDonutChart.generateLegend());
    });


    // Creates line chart of insomnia severity over time
    var ctx_line = $("#lineChart").get(0).getContext("2d");

    $.get("/melon-times.json", function (data) {
      var myLineChart = new Chart(ctx_line).Line(data, options);
      $("#lineLegend").html(myLineChart.generateLegend());
    });




</script>



{% endblock %}